<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UniComm</title>
  <link rel="stylesheet" href="/login-register-styles.css">
</head>
<body>
  <nav>
    <h1><a href="/">UniComm</a></h1>
  </nav>

<form action="/login" method="POST">
  <h2>Login</h2>
  <label for="email">Email</label>
  <input type="text" id="email" name="email" class="placeholder-input" placeholder="Enter your email" required>
  <label for="password">Password</label>
  <input type="password" id="password" name="password" class="placeholder-input" placeholder="Enter your password" required>
  <div class="login error"></div>
  <button type="submit">Login</button>
  <a class="forgot-password", href="/login">Forgot your password?</a>
  <div class="separator"></div> <!-- Add this line -->
  <p class="signup-text">Don't have an account yet? <a href="/register">Sign up</a> instead.</p>
</form>

<script>
  const form = document.querySelector('form');
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const error = document.querySelector('.login.error');
    // Reset errors
    error.textContent = '';
    // Get values
    const email = form.email.value;
    const password = form.password.value;
    try {
        const res = await fetch('/login', { 
            method: 'POST', 
            body: JSON.stringify({ email, password }),
            headers: {'Content-Type': 'application/json'}
        });
        const data = await res.json();
        if (data.errors) {
            error.textContent = data.errors.error;
        }
        if (data.user) {
            location.assign('/'); 
        }
    } catch (err) {
        error.textContent = 'Failed to communicate with the server';  
    }
  });
</script>

<!--
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UniComm</title>
</head>

<body>
  <form action="/login" method="POST">
    <input type="email" placeholder="Email" id="email" name="email" required>
    <input type="password" placeholder="Password" id="password" name="password" required>
    <button type="submit">Log In</button>
    <li><a href="/register">Register</a></li>
  </form>
</body>
</html>
-->